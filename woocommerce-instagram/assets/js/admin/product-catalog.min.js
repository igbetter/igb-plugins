!function(l){"use strict";"undefined"!=typeof wc_instagram_product_catalog_params&&{$body:l("body"),$deleteLink:null,formFields:{},autoUpdateSlug:!0,init:function(){var t=this.getFormField("slug").val();this.autoUpdateSlug=""===t,this.toggleFormFields("slug",""!==t),l(".wc-instagram-field-editable-url").wc_instagram_editable_url(),wc_instagram_product_catalog_params.delete_link&&(this.$deleteLink=l(wc_instagram_product_catalog_params.delete_link),l("#mainform .woocommerce-save-button").after(this.$deleteLink)),this.bindEvents()},bindEvents:function(){var o,a,n,r,s=this;this.getFormField("title").on("keyup",(o=function(){s.autoUpdateSlug&&s.refreshCatalogSlug(l(this).val())},n=!(a=1e3),function(){var t=this,e=arguments,i=n&&!r;clearTimeout(r),r=setTimeout(function(){r=null,n||o.apply(t,e)},a),i&&o.apply(t,e)})),this.getFormField("slug").on("wc_instagram_editable_url_change",function(t,e){s.refreshCatalogSlug(e)}),this.$body.on("wc_instagram_product_catalog_slug_updated",function(t,e){s.autoUpdateSlug=s.autoUpdateSlug&&""===e,s.toggleFormFields("slug",!0),s.getFormField("slug").val(e).trigger("change")}),this.$body.on("wc_instagram_subset_values_updated",function(t,e,i){"product_types"===e&&(e=s.inSubset("variable",i),s.toggleFormFields(["virtual_products","downloadable_products"],s.inSubset("simple",i)),s.toggleFormFields("include_variations",e),s.toggleFormFields(["product_group_id","variation_description_field"],e&&s.getFormField("include_variations").prop("checked")))}),this.$body.on("wc_instagram_subset_fields_loaded",function(){s.filterByToggle(l("input[name=filter_by]:checked").val())}),this.getFormField("include_variations").on("change",function(){var t=l(this).prop("checked");s.toggleFormFields(["product_group_id","variation_description_field"],t)}).trigger("change"),this.getFormField("product_mpn").on("change",function(){s.toggleFormFields("custom_mpn","custom"===l(this).val())}).trigger("change"),this.getFormField("include_tax").on("change",function(){s.toggleFormFields("tax_country","base"!==wc_instagram_product_catalog_params.tax_based_on&&l(this).prop("checked"))}).trigger("change"),this.getFormField("include_stock").on("change",function(){var t=l(this).prop("checked");s.toggleFormFields(["stock_quantity","backorder_stock_quantity"],t)}).trigger("change"),this.$deleteLink&&this.$deleteLink.on("click",function(t){if(!window.confirm(l(this).data("confirm")))return t.preventDefault(),!1}),this.getFormField("products_option").on("change",function(){s.productsOptionToggle(l(this).val())}),l(".form-table").on("change","input[name=filter_by]",function(){s.filterByToggle(l(this).val())})},getFormField:function(t){return this.formFields[t]||(this.formFields[t]=l("#"+t)),this.formFields[t]},toggleFormFields:function(t,i){var o=this;Array.isArray(t)||(t=[t]),l.each(t,function(t,e){o.getFormField(e).closest("tr").toggle(i)})},refreshCatalogSlug:function(t){var e=this;t&&l.post({url:wc_instagram_product_catalog_params.ajax_url,data:{action:"wc_instagram_generate_product_catalog_slug",catalog_id:wc_instagram_product_catalog_params.catalog_id,catalog_title:t},dataType:"json",success:function(t){t.success&&e.$body.trigger("wc_instagram_product_catalog_slug_updated",t.data.slug)}})},inSubset:function(t,e){return""===e.option||"specific"===e.option&&-1!==e.values.indexOf(t)||"all_except"===e.option&&-1===e.values.indexOf(t)},filterByToggle:function(t){var e=t.replace("_","-");l(".show-if-"+e).closest("tr").show(),l(".hide-if-"+e).closest("tr").hide(),l(".wc-instagram-field-subset-option.show-if-"+e).each(function(){l(this).trigger("change")}),l(".wc-instagram-field-subset-option.hide-if-"+e).each(function(){l(this).closest("tr").nextAll("tr").slice(0,2).hide()}),"products"===t&&this.productsOptionToggle()},productsOptionToggle:function(t){t=t||this.getFormField("products_option").val();this.toggleFormFields("include_product_ids","specific"===t),this.toggleFormFields("exclude_product_ids","all_except"===t)}}.init()}(jQuery);